{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\licos\\\\Desktop\\\\projects\\\\shop_online\\\\client\\\\src\\\\components\\\\Modals\\\\CartModal.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState, useContext } from 'react';\nimport { Modal, Button, Form, Container, Row, Col, Spinner } from 'react-bootstrap';\nimport { deleteProductFrCartProducts, fetchCartProductsByCartId, changeCartProducts, sendCart } from './../../http/productAPI';\nimport { observer } from 'mobx-react-lite';\nimport { Context } from './../../index'; //import { createGender } from '../../http/productAPI'\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CartModal = observer(_c = _s(({\n  show,\n  onHide\n}) => {\n  _s();\n\n  const {\n    product,\n    user\n  } = useContext(Context);\n  const [cartInfo, setCartInfo] = useState([]);\n  const [phone, setPhone] = useState('');\n  const [address, setAddress] = useState('');\n  const [images, setImages] = useState([]);\n  const [gotImages, setGotImages] = useState(false);\n\n  if (!product.cartProducts) {\n    console.log('NONONO');\n  }\n\n  const handlePhoneChange = e => {\n    let val = e.target.value;\n    setPhone(val);\n  };\n\n  const handleAddressChange = e => {\n    let userAddress = e.target.value;\n    setAddress(userAddress);\n  };\n\n  let totalAmount = 0;\n\n  if (show) {\n    console.log(user);\n    product.cartProducts.forEach(element => {\n      totalAmount = element.price * element.quantity + totalAmount;\n    });\n  }\n\n  const deleteProduct = productId => {\n    console.log('product', product.cart);\n    deleteProductFrCartProducts(product.cart, productId).then(data => {\n      console.log(data);\n    }).finally(() => {\n      fetchCartProductsByCartId(product.cart).then(data => {\n        product.setCartProducts(data);\n      });\n    });\n  };\n\n  const changeQuantityHandler = (newQuantity, productId) => {\n    if (newQuantity === 0) {\n      //delete from cart\n      deleteProduct(productId);\n    } else {\n      changeCartProducts(product.cart, productId, newQuantity).then(data => {\n        fetchCartProductsByCartId(product.cart).then(data => {\n          product.setCartProducts(data);\n        });\n      });\n    }\n  };\n\n  const sendOrder = () => {\n    sendCart(product.cart).then(data => {\n      console.log(data);\n    }).finally(() => {\n      onHide();\n      product.setCartProducts([]);\n      product.setCart(null);\n      alert('Заказ отправлен');\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    show: show,\n    onHide: onHide,\n    size: \"lg\",\n    top: true,\n    children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n      closeButton: true,\n      children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n        id: \"contained-modal-title-vcenter\",\n        children: \"\\u0412\\u0430\\u0448 \\u0437\\u0430\\u043A\\u0430\\u0437\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n      children: [/*#__PURE__*/_jsxDEV(Container, {\n        children: !product.cartProducts ? /*#__PURE__*/_jsxDEV(Row, {\n          children: \"\\u041D\\u0435\\u0442 \\u0434\\u043E\\u0431\\u0430\\u0432\\u043B\\u0435\\u043D\\u043D\\u044B\\u0445 \\u0442\\u043E\\u0432\\u0430\\u0440\\u043E\\u0432\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 20\n        }, this) : product.cartProducts.map(item => {\n          return /*#__PURE__*/_jsxDEV(Row, {\n            className: \"d-flex justify-content-center align-items-center\",\n            style: {\n              marginTop: '10px',\n              marginBottom: '10px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(Col, {\n              md: 2,\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                style: {\n                  width: '50px',\n                  height: '50px'\n                },\n                src: item.scr,\n                alt: \"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 102,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 101,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              md: 3,\n              children: item.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 106,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              md: 2,\n              children: [/*#__PURE__*/_jsxDEV(Button, {\n                onClick: () => changeQuantityHandler(item.quantity - 1, item.productid),\n                variant: \"light\",\n                className: \"mr-2\",\n                children: \"-\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 110,\n                columnNumber: 37\n              }, this), item.quantity, /*#__PURE__*/_jsxDEV(Button, {\n                onClick: () => changeQuantityHandler(item.quantity + 1, item.productid),\n                className: \"ml-2\",\n                variant: \"light\",\n                children: \"+\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 114,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 109,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              md: 2,\n              children: [item.price, \" \\u0440.\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 118,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              md: 2,\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                onClick: () => deleteProduct(item.productid),\n                variant: \"dark\",\n                children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                  xmlns: \"http://www.w3.org/2000/svg\",\n                  width: \"16\",\n                  height: \"16\",\n                  fill: \"currentColor\",\n                  class: \"bi bi-x\",\n                  viewBox: \"0 0 16 16\",\n                  children: /*#__PURE__*/_jsxDEV(\"path\", {\n                    d: \"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 125,\n                    columnNumber: 45\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 124,\n                  columnNumber: 56\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 122,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 121,\n              columnNumber: 33\n            }, this)]\n          }, item.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 29\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          md: 6\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          md: 6,\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: `Cумма заказа: ${totalAmount} р.`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        style: {\n          display: 'flex',\n          marginLeft: '10px',\n          marginTop: '20px',\n          marginBottom: '20px'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"\\u0423 \\u0432\\u0430\\u0441 \\u043F\\u0440\\u0435\\u043A\\u0440\\u0430\\u0441\\u043D\\u044B\\u0439 \\u0432\\u043A\\u0443\\u0441!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Form, {\n        className: \"d-flex align-items-center justify-content-center flex-column mb-5 w-75\",\n        children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n          className: \"mt-3\",\n          children: \"\\u041A\\u043E\\u043D\\u0442\\u0430\\u043A\\u0442\\u043D\\u044B\\u0435 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n          placeholder: \"\\u0412\\u0430\\u0448 email\",\n          value: user.user.email,\n          type: \"email\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n          value: phone,\n          className: \"phone_mask\",\n          type: \"text\",\n          mask: \"+7(999) 999-99-99\",\n          placeholder: \"+7(999) 999-99-99\",\n          onChange: e => handlePhoneChange(e)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n          className: \"mt-3\",\n          children: \"\\u0414\\u043E\\u0441\\u0442\\u0430\\u0432\\u043A\\u0430\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n          value: address,\n          placeholder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0430\\u0434\\u0440\\u0435\\u0441 \\u0434\\u043E\\u0441\\u0442\\u0430\\u0432\\u043A\\u0438\",\n          type: \"text\",\n          onChange: e => handleAddressChange(e)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          marginLeft: '10px',\n          marginTop: '5px'\n        },\n        children: /*#__PURE__*/_jsxDEV(Col, {\n          children: [/*#__PURE__*/_jsxDEV(Row, {\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"\\u041C\\u044B \\u0441\\u0432\\u044F\\u0436\\u0435\\u043C\\u0441\\u044F \\u0441 \\u0432\\u0430\\u043C\\u0438 \\u0434\\u043B\\u044F \\u043F\\u043E\\u0434\\u0442\\u0432\\u0435\\u0440\\u0436\\u0434\\u0435\\u043D\\u0438\\u044F \\u0437\\u0430\\u043A\\u0430\\u0437\\u0430.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Row, {\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043C\\u0435\\u0440\\u043A\\u0438 \\u043A \\u0437\\u0430\\u043A\\u0430\\u0437\\u0443 \\u043C\\u043E\\u0436\\u043D\\u043E \\u0432 \\u0432\\u0430\\u0448\\u0435\\u043C \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\\u0435.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 176,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"light\",\n        onClick: () => sendOrder(),\n        children: \"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C \\u0434\\u043B\\u044F \\u043F\\u043E\\u0434\\u0442\\u0432\\u0435\\u0440\\u0436\\u0434\\u0435\\u043D\\u0438\\u044F\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 9\n  }, this);\n}, \"lqFXlMATFeGhcl55r72u0+j96jg=\"));\n_c2 = CartModal;\nexport default CartModal;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"CartModal$observer\");\n$RefreshReg$(_c2, \"CartModal\");","map":{"version":3,"sources":["C:/Users/licos/Desktop/projects/shop_online/client/src/components/Modals/CartModal.js"],"names":["React","useEffect","useState","useContext","Modal","Button","Form","Container","Row","Col","Spinner","deleteProductFrCartProducts","fetchCartProductsByCartId","changeCartProducts","sendCart","observer","Context","CartModal","show","onHide","product","user","cartInfo","setCartInfo","phone","setPhone","address","setAddress","images","setImages","gotImages","setGotImages","cartProducts","console","log","handlePhoneChange","e","val","target","value","handleAddressChange","userAddress","totalAmount","forEach","element","price","quantity","deleteProduct","productId","cart","then","data","finally","setCartProducts","changeQuantityHandler","newQuantity","sendOrder","setCart","alert","map","item","marginTop","marginBottom","width","height","scr","name","productid","id","display","marginLeft","email"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useContext } from 'react'\r\nimport { Modal, Button, Form, Container, Row, Col, Spinner } from 'react-bootstrap'\r\nimport { deleteProductFrCartProducts, fetchCartProductsByCartId, changeCartProducts, sendCart } from './../../http/productAPI'\r\nimport { observer } from 'mobx-react-lite'\r\nimport { Context } from './../../index'\r\n//import { createGender } from '../../http/productAPI'\r\n\r\nconst CartModal = observer(({ show, onHide }) => {\r\n\r\n    const { product, user } = useContext(Context)\r\n    const [cartInfo, setCartInfo] = useState([])\r\n    const [phone, setPhone] = useState('')\r\n    const [address, setAddress] = useState('')\r\n    const [images, setImages] = useState([])\r\n    const [gotImages, setGotImages] = useState(false)\r\n    \r\n\r\n    if (!product.cartProducts) {\r\n        console.log('NONONO')\r\n    }\r\n\r\n    const handlePhoneChange = (e) => {\r\n        let val = e.target.value;\r\n        setPhone(val)\r\n    }\r\n    const handleAddressChange = (e) => {\r\n        let userAddress = e.target.value;\r\n        setAddress(userAddress)\r\n    }\r\n\r\n    let totalAmount = 0\r\n\r\n    if (show) {\r\n        console.log(user)\r\n        product.cartProducts.forEach(element => {\r\n            totalAmount = element.price * element.quantity + totalAmount\r\n        });\r\n    }\r\n\r\n    const deleteProduct = (productId) => {\r\n        console.log('product', product.cart)\r\n        deleteProductFrCartProducts(product.cart, productId).then((data) => {\r\n            console.log(data)\r\n        }).finally(() => {\r\n            fetchCartProductsByCartId(product.cart).then(data => {\r\n                product.setCartProducts(data)\r\n            })\r\n        })\r\n    }\r\n\r\n    const changeQuantityHandler = (newQuantity, productId) => {\r\n        if (newQuantity === 0) {\r\n            //delete from cart\r\n            deleteProduct(productId)\r\n        } else {\r\n            changeCartProducts(product.cart, productId, newQuantity).then((data) => {\r\n                fetchCartProductsByCartId(product.cart).then(data => {\r\n                    product.setCartProducts(data)\r\n                })\r\n            })\r\n        }\r\n    }\r\n\r\n    const sendOrder = () => {\r\n        sendCart(product.cart).then((data) => {\r\n            console.log(data)\r\n        }).finally(() => {\r\n            onHide()\r\n            product.setCartProducts([])\r\n            product.setCart(null)\r\n            alert('Заказ отправлен')\r\n        })\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    return (\r\n        <Modal\r\n            show={show}\r\n            onHide={onHide}\r\n            size=\"lg\"\r\n            top\r\n        >\r\n            <Modal.Header closeButton>\r\n                <Modal.Title id=\"contained-modal-title-vcenter\">\r\n                    Ваш заказ\r\n                </Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n                <Container>\r\n                {!product.cartProducts? \r\n                   <Row>\r\n                        Нет добавленных товаров\r\n                    </Row>\r\n                :\r\n                product.cartProducts.map((item) => {\r\n                        return (\r\n                            <Row className=\"d-flex justify-content-center align-items-center\" key={item.id} style={{ marginTop: '10px', marginBottom: '10px' }}>\r\n                                <Col md={2}>\r\n                                    <img\r\n                                        style={{ width: '50px', height: '50px' }}\r\n                                        src={item.scr} alt=''></img>\r\n                                </Col>\r\n                                <Col md={3}>\r\n                                    {item.name}\r\n                                </Col>\r\n                                <Col md={2}>\r\n                                    <Button\r\n                                        onClick={() => changeQuantityHandler(item.quantity - 1, item.productid)}\r\n                                        variant=\"light\" className=\"mr-2\">-</Button>\r\n                                    {item.quantity}\r\n                                    <Button\r\n                                        onClick={() => changeQuantityHandler(item.quantity + 1, item.productid)}\r\n                                        className=\"ml-2\" variant=\"light\">+</Button>\r\n                                </Col>\r\n                                <Col md={2}>\r\n                                    {item.price} р.\r\n                                </Col>\r\n                                <Col md={2}>\r\n                                    <Button\r\n                                        onClick={() => deleteProduct(item.productid)}\r\n                                        variant=\"dark\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-x\" viewBox=\"0 0 16 16\">\r\n                                            <path d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\" />\r\n                                        </svg></Button>\r\n                                </Col>\r\n                            </Row>\r\n                        )\r\n                    })}\r\n                    \r\n                </Container>\r\n                <br />\r\n                <Row>\r\n                    <Col md={6}>\r\n                    </Col>\r\n                    <Col md={6}>\r\n                        <h3>{`Cумма заказа: ${totalAmount} р.`}</h3>\r\n                    </Col>\r\n                </Row>\r\n                <Row style={{ display: 'flex', marginLeft: '10px', marginTop: '20px', marginBottom: '20px' }}>\r\n                    <h4>У вас прекрасный вкус!</h4>\r\n                </Row>\r\n\r\n                <Form\r\n                    className=\"d-flex align-items-center justify-content-center flex-column mb-5 w-75\"\r\n                >\r\n                    <h5 className=\"mt-3\">Контактные данные</h5>\r\n                    <Form.Control\r\n                        placeholder='Ваш email'\r\n                        value={user.user.email}\r\n                        type='email'\r\n                    />\r\n                    <Form.Control\r\n                        value={phone}\r\n                        className=\"phone_mask\"\r\n                        type=\"text\"\r\n                        mask=\"+7(999) 999-99-99\"\r\n                        placeholder=\"+7(999) 999-99-99\"\r\n                        onChange={(e) => handlePhoneChange(e)}\r\n                    />\r\n                    <h5 className=\"mt-3\">Доставка</h5>\r\n                    <Form.Control\r\n                        value={address}\r\n                        placeholder='Введите адрес доставки'\r\n                        type='text'\r\n                        onChange={(e) => handleAddressChange(e)}\r\n                    />\r\n                </Form>\r\n                <div style={{ display: 'flex', marginLeft: '10px', marginTop: '5px' }}>\r\n                    <Col>\r\n                        <Row>\r\n                            <p>Мы свяжемся с вами для подтверждения заказа.</p>\r\n                        </Row>\r\n                        <Row>\r\n                            <p>Добавить мерки к заказу можно в вашем профиле.</p>\r\n                        </Row>\r\n                    </Col>\r\n                </div>\r\n            </Modal.Body>\r\n            <Modal.Footer>\r\n                <Button variant={\"light\"} onClick={() => sendOrder()}>Отправить для подтверждения</Button>\r\n            </Modal.Footer>\r\n        </Modal >\r\n    )\r\n})\r\n\r\nexport default CartModal;"]},"metadata":{},"sourceType":"module"}