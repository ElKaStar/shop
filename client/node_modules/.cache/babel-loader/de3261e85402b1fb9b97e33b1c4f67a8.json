{"ast":null,"code":"import _toConsumableArray from\"C:/Users/licos/Desktop/projects/shop_online/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/licos/Desktop/projects/shop_online/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useEffect,useState}from'react';import{Modal,Button,Form,Dropdown,Row,Col}from'react-bootstrap';import{fetchProperties,fetchTypes,fetchGenders,createProperty,fetchCatalogs,createCatalogsInfo}from'../../http/productAPI';import{Context}from'../../index';import{observer}from'mobx-react-lite';import{createProduct,uploadImage,uploadProductInfo}from'../../http/productAPI';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CreateProduct=observer(function(_ref){var show=_ref.show,onHide=_ref.onHide;var _useContext=useContext(Context),product=_useContext.product;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),info=_useState2[0],setInfo=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),images=_useState4[0],setImages=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),name=_useState6[0],setName=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),price=_useState8[0],setPrice=_useState8[1];var addInfo=function addInfo(){setInfo([].concat(_toConsumableArray(info),[{title:\"\",description:\"\",id:\"\",number:Date.now()}]));};var removeInfo=function removeInfo(number){setInfo(info.filter(function(i){return i.number!==number;}));};var removeImage=function removeImage(number){setImages(images.filter(function(i){return i.number!==number;}));};var addImage=function addImage(){setImages([].concat(_toConsumableArray(images),[{src:'',number:Date.now()}]));};var selectFile=function selectFile(e,number){var newFiles=_toConsumableArray(images);newFiles.map(function(item){if(item.number===number){item.src=e.target.value;}return item;});};var showImages=function showImages(){console.log(images);};var selectInfo=function selectInfo(id,title,number){console.log(id,title,number);var newInfo=_toConsumableArray(info);newInfo.map(function(item){if(item.number===number){item.title=title;item.id=id;}return item;});setInfo(newInfo);};var addDescription=function addDescription(e,number){var newInfo=_toConsumableArray(info);newInfo.map(function(item){if(item.number===number){item.description=e.target.value;}return item;});setInfo(newInfo);};useEffect(function(){fetchTypes().then(function(data){return product.setTypes(data);});fetchGenders().then(function(data){return product.setGenders(data);});fetchProperties().then(function(data){return product.setProperties(data);});fetchCatalogs().then(function(data){return product.setCatalogs(data);});},[info]);//name, price, typeId, genderId\nvar addProduct=function addProduct(){createProduct(name,price,product.selectedType.id,product.selectedGender.id).then(function(data){images.forEach(function(element){uploadImage(data.id,element.src).then(function(data){return console.log(data);});}).finally(function(){return setImages([]);});//add info\ninfo.forEach(function(element){uploadProductInfo(data.id,element.id,element.description).then(function(data){return setInfo([]);});});createCatalogsInfo(product.selectedCatalog.name,product.selectedCatalog.id,data.id);});onHide();};return/*#__PURE__*/_jsxs(Modal,{show:show,onHide:onHide,size:\"lg\",centered:true,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{id:\"contained-modal-title-vcenter\",children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043D\\u043E\\u0432\\u044B\\u0439 \\u0442\\u043E\\u0432\\u0430\\u0440\"})}),/*#__PURE__*/_jsxs(Modal.Body,{children:[/*#__PURE__*/_jsxs(Dropdown,{className:\"mt-2 mb-2\",children:[/*#__PURE__*/_jsx(Dropdown.Toggle,{children:product.selectedType.name||'Выберете тип товара'}),/*#__PURE__*/_jsx(Dropdown.Menu,{children:product.types.map(function(el){return/*#__PURE__*/_jsx(Dropdown.Item,{onClick:function onClick(){return product.setSelectedType(el);},children:el.name},el.id);})})]}),/*#__PURE__*/_jsxs(Dropdown,{className:\"mt-2 mb-2\",children:[/*#__PURE__*/_jsx(Dropdown.Toggle,{children:product.selectedGender.name||'Выберете вид товара'}),/*#__PURE__*/_jsx(Dropdown.Menu,{children:product.genders.map(function(el){return/*#__PURE__*/_jsx(Dropdown.Item,{onClick:function onClick(){return product.setSelectedGender(el);},children:el.name},el.id);})})]}),/*#__PURE__*/_jsxs(Dropdown,{className:\"mt-2 mb-2\",children:[/*#__PURE__*/_jsx(Dropdown.Toggle,{children:product.selectedCatalog.name||'Выберете каталог для товара'}),/*#__PURE__*/_jsx(Dropdown.Menu,{children:product.catalogs.map(function(el){return/*#__PURE__*/_jsx(Dropdown.Item,{onClick:function onClick(){return product.setSelectedCatalog(el);},children:el.name},el.id);})})]}),/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsx(Form.Control,{style:{marginTop:3},placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043D\\u0430\\u0438\\u043C\\u0435\\u043D\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430\",value:name,onChange:function onChange(e){return setName(e.target.value);}}),/*#__PURE__*/_jsx(Form.Control,{style:{marginTop:3},placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u0442\\u043E\\u0438\\u043C\\u043Ec\\u0442\\u044C \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430\",type:\"number\",value:price,onChange:function onChange(e){return setPrice(Number(e.target.value));}})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(Button,{variant:\"outline-dark\",onClick:addImage,children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043D\\u043E\\u0432\\u0443\\u044E \\u0444\\u043E\\u0442\\u043E\\u0433\\u0440\\u0430\\u0444\\u0438\\u044E\"}),images.map(function(i){return/*#__PURE__*/_jsxs(Row,{className:\"mt-3\",children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsx(Form.Control,{value:images.scr,type:\"text\",onChange:function onChange(e){return selectFile(e,i.number);}})}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return removeImage(i.number);},variant:\"outline-danger\",children:\"x\"})})]},i.number);}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(Button,{variant:\"outline-dark\",onClick:addInfo,children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0445\\u0430\\u0440\\u0430\\u043A\\u0442\\u0435\\u0440\\u0438\\u0441\\u0442\\u0438\\u043A\\u0443 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430\"}),info.map(function(i){return/*#__PURE__*/_jsxs(Row,{className:\"mt-3 d-flex align-items-center justify-content-center\",children:[/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsxs(Dropdown,{className:\"mt-2 mb-2\",children:[/*#__PURE__*/_jsx(Dropdown.Toggle,{children:i.title||'Выберите свойство товара'}),/*#__PURE__*/_jsx(Dropdown.Menu,{children:product.properties.map(function(el){return/*#__PURE__*/_jsx(Dropdown.Item,{onClick:function onClick(){return selectInfo(el.id,el.name,i.number);},children:el.name},el.id);})})]})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Form.Control,{placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0437\\u043D\\u0430\\u0447\\u0435\\u043D\\u0438\\u0435 \\u0441\\u0432\\u043E\\u0439\\u0441\\u0442\\u0432\\u0430\",value:i.description,onChange:function onChange(e){return addDescription(e,i.number);}})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Button,{variant:\"outline-danger\",onClick:function onClick(){return removeInfo(i.number);},children:\"x\"})})]},i.number);})]}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"outline-success\",onClick:addProduct,children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"}),/*#__PURE__*/_jsx(Button,{variant:\"outline-danger\",onClick:onHide,children:\"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\"}),/*#__PURE__*/_jsx(Button,{onClick:showImages,children:\"\\u0432 \\u043A\\u043E\\u043D\\u0441\\u043E\\u043B\\u0438\"})]})]});});export default CreateProduct;","map":{"version":3,"sources":["C:/Users/licos/Desktop/projects/shop_online/client/src/components/Modals/CreateProduct.js"],"names":["React","useContext","useEffect","useState","Modal","Button","Form","Dropdown","Row","Col","fetchProperties","fetchTypes","fetchGenders","createProperty","fetchCatalogs","createCatalogsInfo","Context","observer","createProduct","uploadImage","uploadProductInfo","CreateProduct","show","onHide","product","info","setInfo","images","setImages","name","setName","price","setPrice","addInfo","title","description","id","number","Date","now","removeInfo","filter","i","removeImage","addImage","src","selectFile","e","newFiles","map","item","target","value","showImages","console","log","selectInfo","newInfo","addDescription","then","data","setTypes","setGenders","setProperties","setCatalogs","addProduct","selectedType","selectedGender","forEach","element","finally","selectedCatalog","types","el","setSelectedType","genders","setSelectedGender","catalogs","setSelectedCatalog","marginTop","Number","scr","properties"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from 'react'\r\nimport { Modal, Button, Form, Dropdown, Row, Col } from 'react-bootstrap'\r\nimport { fetchProperties, fetchTypes, fetchGenders, createProperty, fetchCatalogs, createCatalogsInfo } from '../../http/productAPI'\r\nimport { Context } from '../../index'\r\nimport { observer } from 'mobx-react-lite'\r\nimport { createProduct, uploadImage, uploadProductInfo } from '../../http/productAPI'\r\n\r\nconst CreateProduct = observer(({ show, onHide }) => {\r\n\r\n    const { product } = useContext(Context)\r\n    const [info, setInfo] = useState([])\r\n    const [images, setImages] = useState([])\r\n\r\n    const [name, setName] = useState('')\r\n    const [price, setPrice] = useState('')\r\n\r\n\r\n\r\n    const addInfo = () => {\r\n        setInfo([...info, { title: \"\", description: \"\", id: \"\", number: Date.now() }])\r\n    }\r\n\r\n    const removeInfo = (number) => {\r\n        setInfo(info.filter(i => i.number !== number))\r\n    }\r\n\r\n    const removeImage = (number) => {\r\n        setImages(images.filter(i => i.number !== number))\r\n    }\r\n\r\n    const addImage = () => {\r\n        setImages([...images, { src: '', number: Date.now() }])\r\n    }\r\n\r\n    const selectFile = (e, number) => {\r\n        const newFiles = [...images]\r\n        newFiles.map((item) => {\r\n            if (item.number === number) {\r\n                item.src = e.target.value\r\n            }\r\n            return item\r\n        })\r\n    }\r\n\r\n    const showImages = () => {\r\n        console.log(images)\r\n    }\r\n\r\n    const selectInfo = (id, title, number) => {\r\n        console.log(id, title, number)\r\n        const newInfo = [...info]\r\n        newInfo.map((item) => {\r\n            if (item.number === number) {\r\n                item.title = title\r\n                item.id = id\r\n            }\r\n            return item\r\n        })\r\n        setInfo(newInfo)\r\n    }\r\n\r\n    const addDescription = (e, number) => {\r\n        const newInfo = [...info]\r\n        newInfo.map((item) => {\r\n            if (item.number === number) {\r\n                item.description = e.target.value\r\n            }\r\n            return item\r\n        })\r\n        setInfo(newInfo)\r\n    }\r\n\r\n\r\n    useEffect(() => {\r\n        fetchTypes().then(data => product.setTypes(data))\r\n        fetchGenders().then(data => product.setGenders(data))\r\n        fetchProperties().then(data => product.setProperties(data))\r\n        fetchCatalogs().then(data => product.setCatalogs(data))\r\n    }, [info])\r\n\r\n    //name, price, typeId, genderId\r\n    const addProduct = () => {\r\n\r\n\r\n        createProduct(name, price, product.selectedType.id, product.selectedGender.id)\r\n            .then(data => {\r\n                images.forEach((element) => {\r\n                    uploadImage(data.id, element.src).then(data => console.log(data))\r\n                }).finally(() => setImages([]))\r\n                //add info\r\n                info.forEach((element) => {\r\n                    uploadProductInfo(data.id, element.id, element.description).then(data => setInfo([]))\r\n                })\r\n                createCatalogsInfo(product.selectedCatalog.name, product.selectedCatalog.id, data.id)\r\n            })\r\n        onHide()\r\n    }\r\n\r\n    return (\r\n        <Modal\r\n            show={show}\r\n            onHide={onHide}\r\n            size=\"lg\"\r\n            centered\r\n        >\r\n            <Modal.Header closeButton>\r\n                <Modal.Title id=\"contained-modal-title-vcenter\">\r\n                    Добавить новый товар\r\n                </Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n                <Dropdown className=\"mt-2 mb-2\">\r\n                    <Dropdown.Toggle>{product.selectedType.name || 'Выберете тип товара'}</Dropdown.Toggle>\r\n                    <Dropdown.Menu>\r\n                        {product.types.map(el =>\r\n                            <Dropdown.Item onClick={() => product.setSelectedType(el)} key={el.id}>{el.name}</Dropdown.Item>\r\n                        )}\r\n                    </Dropdown.Menu>\r\n                </Dropdown>\r\n                <Dropdown className=\"mt-2 mb-2\">\r\n                    <Dropdown.Toggle>{product.selectedGender.name || 'Выберете вид товара'}</Dropdown.Toggle>\r\n                    <Dropdown.Menu>\r\n                        {product.genders.map(el =>\r\n                            <Dropdown.Item onClick={() => product.setSelectedGender(el)} key={el.id}>{el.name}</Dropdown.Item>\r\n                        )}\r\n                    </Dropdown.Menu>\r\n                </Dropdown>\r\n                <Dropdown className=\"mt-2 mb-2\">\r\n                    <Dropdown.Toggle>{product.selectedCatalog.name || 'Выберете каталог для товара'}</Dropdown.Toggle>\r\n                    <Dropdown.Menu>\r\n                        {product.catalogs.map(el =>\r\n                            <Dropdown.Item onClick={() => product.setSelectedCatalog(el)} key={el.id}>{el.name}</Dropdown.Item>\r\n                        )}\r\n                    </Dropdown.Menu>\r\n                </Dropdown>\r\n                <Form>\r\n                    <Form.Control\r\n                        style={{ marginTop: 3 }}\r\n                        placeholder=\"Введите наименование товара\"\r\n                        value={name}\r\n                        onChange={(e) => setName(e.target.value)}\r\n                    />\r\n                    <Form.Control\r\n                        style={{ marginTop: 3 }}\r\n                        placeholder=\"Введите стоимоcть товара\"\r\n                        type=\"number\"\r\n                        value={price}\r\n                        onChange={(e) => setPrice(Number(e.target.value))}\r\n                    />\r\n                </Form>\r\n                <hr />\r\n                <Button\r\n                    variant={\"outline-dark\"}\r\n                    onClick={addImage}\r\n                >\r\n                    Добавить новую фотографию\r\n                </Button>\r\n                {images.map((i) =>\r\n                    <Row\r\n                        key={i.number}\r\n                        className=\"mt-3\"\r\n                    >\r\n                        <Col md={6}>\r\n                            <Form.Control\r\n                                value={images.scr}\r\n                                type=\"text\"\r\n                                onChange={(e) => selectFile(e, i.number)}\r\n                            />\r\n                        </Col>\r\n                        <Col md={6}>\r\n                            <Button onClick={() => removeImage(i.number)} variant={\"outline-danger\"}>x</Button>\r\n                        </Col>\r\n                    </Row>\r\n                )}\r\n                <hr />\r\n                <Button\r\n                    variant={\"outline-dark\"}\r\n                    onClick={addInfo}\r\n                >\r\n                    Добавить характеристику товара\r\n                </Button>\r\n                {\r\n                    info.map(i =>\r\n                        <Row className=\"mt-3 d-flex align-items-center justify-content-center\" key={i.number}>\r\n                            <Col md={4}>\r\n                                <Dropdown className=\"mt-2 mb-2\">\r\n                                    <Dropdown.Toggle>{i.title || 'Выберите свойство товара'}</Dropdown.Toggle>\r\n                                    <Dropdown.Menu>\r\n                                        {product.properties.map(el =>\r\n                                            <Dropdown.Item onClick={() => selectInfo(el.id, el.name, i.number)} key={el.id}>{el.name}</Dropdown.Item>\r\n                                        )}\r\n                                    </Dropdown.Menu>\r\n                                </Dropdown>\r\n                            </Col>\r\n                            <Col md={4}>\r\n                                <Form.Control\r\n                                    placeholder=\"Введите значение свойства\"\r\n                                    value={i.description}\r\n                                    onChange={(e) => addDescription(e, i.number)}\r\n                                />\r\n                            </Col>\r\n                            <Col md={4}>\r\n                                <Button\r\n                                    variant={\"outline-danger\"}\r\n                                    onClick={() => removeInfo(i.number)}\r\n                                >\r\n                                    x\r\n                                </Button>\r\n                            </Col>\r\n                        </Row>\r\n                    )\r\n                }\r\n            </Modal.Body>\r\n            <Modal.Footer>\r\n                <Button variant={\"outline-success\"} onClick={addProduct}>Сохранить</Button>\r\n                <Button variant={\"outline-danger\"} onClick={onHide}>Закрыть</Button>\r\n                <Button onClick={showImages}>в консоли</Button>\r\n            </Modal.Footer>\r\n        </Modal>\r\n    )\r\n})\r\n\r\nexport default CreateProduct;"]},"metadata":{},"sourceType":"module"}