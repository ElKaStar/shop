{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\licos\\\\Desktop\\\\projects\\\\shop_online\\\\client\\\\src\\\\components\\\\Modals\\\\CreateProduct.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport { Modal, Button, Form, Dropdown, Row, Col } from 'react-bootstrap';\nimport { fetchProperties, fetchTypes, fetchGenders, createProperty, fetchCatalogs, createCatalogsInfo } from '../../http/productAPI';\nimport { Context } from '../../index';\nimport { observer } from 'mobx-react-lite';\nimport { createProduct, uploadImage, uploadProductInfo } from '../../http/productAPI';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CreateProduct = observer(_c = _s(({\n  show,\n  onHide\n}) => {\n  _s();\n\n  const {\n    product\n  } = useContext(Context);\n  const [info, setInfo] = useState([]);\n  const [images, setImages] = useState([]);\n  const [name, setName] = useState('');\n  const [price, setPrice] = useState('');\n  const [selectedCatalog, setSelectedCatalog] = useState(null);\n\n  const addInfo = () => {\n    setInfo([...info, {\n      title: \"\",\n      description: \"\",\n      id: \"\",\n      number: Date.now()\n    }]);\n  };\n\n  const removeInfo = number => {\n    setInfo(info.filter(i => i.number !== number));\n  };\n\n  const removeImage = number => {\n    setImages(images.filter(i => i.number !== number));\n  };\n\n  const addImage = () => {\n    setImages([...images, {\n      src: '',\n      number: Date.now()\n    }]);\n  };\n\n  const selectFile = (e, number) => {\n    const newFiles = [...images];\n    newFiles.map(item => {\n      if (item.number === number) {\n        item.src = e.target.files[0];\n      }\n\n      return item;\n    });\n  };\n\n  const showImages = () => {\n    console.log(images);\n  };\n\n  const selectInfo = (id, title, number) => {\n    console.log(id, title, number);\n    const newInfo = [...info];\n    newInfo.map(item => {\n      if (item.number === number) {\n        item.title = title;\n        item.id = id;\n      }\n\n      return item;\n    });\n    setInfo(newInfo);\n  };\n\n  const addDescription = (e, number) => {\n    const newInfo = [...info];\n    newInfo.map(item => {\n      if (item.number === number) {\n        item.description = e.target.value;\n      }\n\n      return item;\n    });\n    setInfo(newInfo);\n  };\n\n  const selectedCatalogHandling = el => {\n    product.setSelectedCatalog(el);\n    setSelectedCatalog(el);\n  };\n\n  useEffect(() => {\n    fetchTypes().then(data => product.setTypes(data));\n    fetchGenders().then(data => product.setGenders(data));\n    fetchProperties().then(data => product.setProperties(data));\n    fetchCatalogs().then(data => product.setCatalogs(data));\n  }, []); //name, price, typeId, genderId\n\n  const addProduct = () => {\n    createProduct(name, price, product.selectedType.id, product.selectedGender.id).then(data => {\n      images.forEach(element => {\n        const formData = new FormData();\n        formData.append('productId', data.id);\n        formData.append('scr', element.src);\n        uploadImage(formData).then(data => setImages([]));\n      });\n      setImages([]); //add info\n\n      info.forEach(element => {\n        uploadProductInfo(data.id, element.id, element.description).then(data => setInfo([]));\n      });\n      createCatalogsInfo(selectedCatalog.name, selectedCatalog.id, data.id);\n    });\n    onHide();\n  };\n\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    show: show,\n    onHide: onHide,\n    size: \"lg\",\n    centered: true,\n    children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n      closeButton: true,\n      children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n        id: \"contained-modal-title-vcenter\",\n        children: \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043D\\u043E\\u0432\\u044B\\u0439 \\u0442\\u043E\\u0432\\u0430\\u0440\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n      children: [/*#__PURE__*/_jsxDEV(Dropdown, {\n        className: \"mt-2 mb-2\",\n        children: [/*#__PURE__*/_jsxDEV(Dropdown.Toggle, {\n          children: product.selectedType.name || 'Выберете тип товара'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Dropdown.Menu, {\n          children: product.types.map(el => /*#__PURE__*/_jsxDEV(Dropdown.Item, {\n            onClick: () => product.setSelectedType(el),\n            children: el.name\n          }, el.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 29\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Dropdown, {\n        className: \"mt-2 mb-2\",\n        children: [/*#__PURE__*/_jsxDEV(Dropdown.Toggle, {\n          children: product.selectedGender.name || 'Выберете вид товара'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Dropdown.Menu, {\n          children: product.genders.map(el => /*#__PURE__*/_jsxDEV(Dropdown.Item, {\n            onClick: () => product.setSelectedGender(el),\n            children: el.name\n          }, el.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 29\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Dropdown, {\n        className: \"mt-2 mb-2\",\n        children: [/*#__PURE__*/_jsxDEV(Dropdown.Toggle, {\n          children: product.selectedCatalog.name || 'Выберете каталог для товара'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Dropdown.Menu, {\n          children: product.catalogs.map(el => /*#__PURE__*/_jsxDEV(Dropdown.Item, {\n            onClick: () => selectedCatalogHandling(el),\n            children: el.name\n          }, el.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 29\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Form, {\n        children: [/*#__PURE__*/_jsxDEV(Form.Control, {\n          style: {\n            marginTop: 3\n          },\n          placeholder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043D\\u0430\\u0438\\u043C\\u0435\\u043D\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430\",\n          value: name,\n          onChange: e => setName(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n          style: {\n            marginTop: 3\n          },\n          placeholder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u0442\\u043E\\u0438\\u043C\\u043Ec\\u0442\\u044C \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430\",\n          type: \"number\",\n          value: price,\n          onChange: e => setPrice(Number(e.target.value))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"outline-dark\",\n        onClick: addImage,\n        children: \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043D\\u043E\\u0432\\u0443\\u044E \\u0444\\u043E\\u0442\\u043E\\u0433\\u0440\\u0430\\u0444\\u0438\\u044E\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 17\n      }, this), images.map(i => /*#__PURE__*/_jsxDEV(Row, {\n        className: \"mt-3\",\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          md: 6,\n          children: /*#__PURE__*/_jsxDEV(Form.Control, {\n            type: \"file\",\n            onChange: e => selectFile(e, i.number)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          md: 6,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            onClick: () => removeImage(i.number),\n            variant: \"outline-danger\",\n            children: \"x\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 25\n        }, this)]\n      }, i.number, true, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 21\n      }, this)), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"outline-dark\",\n        onClick: addInfo,\n        children: \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0445\\u0430\\u0440\\u0430\\u043A\\u0442\\u0435\\u0440\\u0438\\u0441\\u0442\\u0438\\u043A\\u0443 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 17\n      }, this), info.map(i => /*#__PURE__*/_jsxDEV(Row, {\n        className: \"mt-3 d-flex align-items-center justify-content-center\",\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          md: 4,\n          children: /*#__PURE__*/_jsxDEV(Dropdown, {\n            className: \"mt-2 mb-2\",\n            children: [/*#__PURE__*/_jsxDEV(Dropdown.Toggle, {\n              children: i.title || 'Выберите свойство товара'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 195,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(Dropdown.Menu, {\n              children: product.properties.map(el => /*#__PURE__*/_jsxDEV(Dropdown.Item, {\n                onClick: () => selectInfo(el.id, el.name, i.number),\n                children: el.name\n              }, el.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 45\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          md: 4,\n          children: /*#__PURE__*/_jsxDEV(Form.Control, {\n            placeholder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0437\\u043D\\u0430\\u0447\\u0435\\u043D\\u0438\\u0435 \\u0441\\u0432\\u043E\\u0439\\u0441\\u0442\\u0432\\u0430\",\n            value: i.description,\n            onChange: e => addDescription(e, i.number)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          md: 4,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"outline-danger\",\n            onClick: () => removeInfo(i.number),\n            children: \"x\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 29\n        }, this)]\n      }, i.number, true, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 25\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        variant: \"outline-success\",\n        onClick: addProduct,\n        children: \"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"outline-danger\",\n        onClick: onHide,\n        children: \"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        onClick: showImages,\n        children: \"\\u0432 \\u043A\\u043E\\u043D\\u0441\\u043E\\u043B\\u0438\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 109,\n    columnNumber: 9\n  }, this);\n}, \"mg/sTqeivpvRCRGMkSmODmIqQFo=\"));\n_c2 = CreateProduct;\nexport default CreateProduct;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"CreateProduct$observer\");\n$RefreshReg$(_c2, \"CreateProduct\");","map":{"version":3,"sources":["C:/Users/licos/Desktop/projects/shop_online/client/src/components/Modals/CreateProduct.js"],"names":["React","useContext","useEffect","useState","Modal","Button","Form","Dropdown","Row","Col","fetchProperties","fetchTypes","fetchGenders","createProperty","fetchCatalogs","createCatalogsInfo","Context","observer","createProduct","uploadImage","uploadProductInfo","CreateProduct","show","onHide","product","info","setInfo","images","setImages","name","setName","price","setPrice","selectedCatalog","setSelectedCatalog","addInfo","title","description","id","number","Date","now","removeInfo","filter","i","removeImage","addImage","src","selectFile","e","newFiles","map","item","target","files","showImages","console","log","selectInfo","newInfo","addDescription","value","selectedCatalogHandling","el","then","data","setTypes","setGenders","setProperties","setCatalogs","addProduct","selectedType","selectedGender","forEach","element","formData","FormData","append","types","setSelectedType","genders","setSelectedGender","catalogs","marginTop","Number","properties"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,UAAhB,EAA4BC,SAA5B,EAAuCC,QAAvC,QAAuD,OAAvD;AACA,SAASC,KAAT,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,QAA9B,EAAwCC,GAAxC,EAA6CC,GAA7C,QAAwD,iBAAxD;AACA,SAASC,eAAT,EAA0BC,UAA1B,EAAsCC,YAAtC,EAAoDC,cAApD,EAAoEC,aAApE,EAAmFC,kBAAnF,QAA6G,uBAA7G;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,QAAT,QAAyB,iBAAzB;AACA,SAASC,aAAT,EAAwBC,WAAxB,EAAqCC,iBAArC,QAA8D,uBAA9D;;AAEA,MAAMC,aAAa,GAAGJ,QAAQ,SAAC,CAAC;AAAEK,EAAAA,IAAF;AAAQC,EAAAA;AAAR,CAAD,KAAsB;AAAA;;AAEjD,QAAM;AAAEC,IAAAA;AAAF,MAAcvB,UAAU,CAACe,OAAD,CAA9B;AACA,QAAM,CAACS,IAAD,EAAOC,OAAP,IAAkBvB,QAAQ,CAAC,EAAD,CAAhC;AACA,QAAM,CAACwB,MAAD,EAASC,SAAT,IAAsBzB,QAAQ,CAAC,EAAD,CAApC;AAEA,QAAM,CAAC0B,IAAD,EAAOC,OAAP,IAAkB3B,QAAQ,CAAC,EAAD,CAAhC;AACA,QAAM,CAAC4B,KAAD,EAAQC,QAAR,IAAoB7B,QAAQ,CAAC,EAAD,CAAlC;AACA,QAAM,CAAC8B,eAAD,EAAkBC,kBAAlB,IAAwC/B,QAAQ,CAAC,IAAD,CAAtD;;AAIA,QAAMgC,OAAO,GAAG,MAAM;AAClBT,IAAAA,OAAO,CAAC,CAAC,GAAGD,IAAJ,EAAU;AAAEW,MAAAA,KAAK,EAAE,EAAT;AAAaC,MAAAA,WAAW,EAAE,EAA1B;AAA8BC,MAAAA,EAAE,EAAE,EAAlC;AAAsCC,MAAAA,MAAM,EAAEC,IAAI,CAACC,GAAL;AAA9C,KAAV,CAAD,CAAP;AACH,GAFD;;AAIA,QAAMC,UAAU,GAAIH,MAAD,IAAY;AAC3Bb,IAAAA,OAAO,CAACD,IAAI,CAACkB,MAAL,CAAYC,CAAC,IAAIA,CAAC,CAACL,MAAF,KAAaA,MAA9B,CAAD,CAAP;AACH,GAFD;;AAIA,QAAMM,WAAW,GAAIN,MAAD,IAAY;AAC5BX,IAAAA,SAAS,CAACD,MAAM,CAACgB,MAAP,CAAcC,CAAC,IAAIA,CAAC,CAACL,MAAF,KAAaA,MAAhC,CAAD,CAAT;AACH,GAFD;;AAIA,QAAMO,QAAQ,GAAG,MAAM;AACnBlB,IAAAA,SAAS,CAAC,CAAC,GAAGD,MAAJ,EAAY;AAAEoB,MAAAA,GAAG,EAAE,EAAP;AAAWR,MAAAA,MAAM,EAAEC,IAAI,CAACC,GAAL;AAAnB,KAAZ,CAAD,CAAT;AACH,GAFD;;AAIA,QAAMO,UAAU,GAAG,CAACC,CAAD,EAAIV,MAAJ,KAAe;AAC9B,UAAMW,QAAQ,GAAG,CAAC,GAAGvB,MAAJ,CAAjB;AACAuB,IAAAA,QAAQ,CAACC,GAAT,CAAcC,IAAD,IAAU;AACnB,UAAIA,IAAI,CAACb,MAAL,KAAgBA,MAApB,EAA4B;AACxBa,QAAAA,IAAI,CAACL,GAAL,GAAWE,CAAC,CAACI,MAAF,CAASC,KAAT,CAAe,CAAf,CAAX;AACH;;AACD,aAAOF,IAAP;AACH,KALD;AAMH,GARD;;AAUA,QAAMG,UAAU,GAAG,MAAM;AACrBC,IAAAA,OAAO,CAACC,GAAR,CAAY9B,MAAZ;AACH,GAFD;;AAIA,QAAM+B,UAAU,GAAG,CAACpB,EAAD,EAAKF,KAAL,EAAYG,MAAZ,KAAuB;AACtCiB,IAAAA,OAAO,CAACC,GAAR,CAAYnB,EAAZ,EAAgBF,KAAhB,EAAuBG,MAAvB;AACA,UAAMoB,OAAO,GAAG,CAAC,GAAGlC,IAAJ,CAAhB;AACAkC,IAAAA,OAAO,CAACR,GAAR,CAAaC,IAAD,IAAU;AAClB,UAAIA,IAAI,CAACb,MAAL,KAAgBA,MAApB,EAA4B;AACxBa,QAAAA,IAAI,CAAChB,KAAL,GAAaA,KAAb;AACAgB,QAAAA,IAAI,CAACd,EAAL,GAAUA,EAAV;AACH;;AACD,aAAOc,IAAP;AACH,KAND;AAOA1B,IAAAA,OAAO,CAACiC,OAAD,CAAP;AACH,GAXD;;AAaA,QAAMC,cAAc,GAAG,CAACX,CAAD,EAAIV,MAAJ,KAAe;AAClC,UAAMoB,OAAO,GAAG,CAAC,GAAGlC,IAAJ,CAAhB;AACAkC,IAAAA,OAAO,CAACR,GAAR,CAAaC,IAAD,IAAU;AAClB,UAAIA,IAAI,CAACb,MAAL,KAAgBA,MAApB,EAA4B;AACxBa,QAAAA,IAAI,CAACf,WAAL,GAAmBY,CAAC,CAACI,MAAF,CAASQ,KAA5B;AACH;;AACD,aAAOT,IAAP;AACH,KALD;AAMA1B,IAAAA,OAAO,CAACiC,OAAD,CAAP;AACH,GATD;;AAWA,QAAMG,uBAAuB,GAAIC,EAAD,IAAQ;AACpCvC,IAAAA,OAAO,CAACU,kBAAR,CAA2B6B,EAA3B;AACA7B,IAAAA,kBAAkB,CAAC6B,EAAD,CAAlB;AACH,GAHD;;AAMA7D,EAAAA,SAAS,CAAC,MAAM;AACZS,IAAAA,UAAU,GAAGqD,IAAb,CAAkBC,IAAI,IAAIzC,OAAO,CAAC0C,QAAR,CAAiBD,IAAjB,CAA1B;AACArD,IAAAA,YAAY,GAAGoD,IAAf,CAAoBC,IAAI,IAAIzC,OAAO,CAAC2C,UAAR,CAAmBF,IAAnB,CAA5B;AACAvD,IAAAA,eAAe,GAAGsD,IAAlB,CAAuBC,IAAI,IAAIzC,OAAO,CAAC4C,aAAR,CAAsBH,IAAtB,CAA/B;AACAnD,IAAAA,aAAa,GAAGkD,IAAhB,CAAqBC,IAAI,IAAIzC,OAAO,CAAC6C,WAAR,CAAoBJ,IAApB,CAA7B;AACH,GALQ,EAKN,EALM,CAAT,CAxEiD,CA+EjD;;AACA,QAAMK,UAAU,GAAG,MAAM;AACrBpD,IAAAA,aAAa,CAACW,IAAD,EAAOE,KAAP,EAAcP,OAAO,CAAC+C,YAAR,CAAqBjC,EAAnC,EAAuCd,OAAO,CAACgD,cAAR,CAAuBlC,EAA9D,CAAb,CACK0B,IADL,CACUC,IAAI,IAAI;AACVtC,MAAAA,MAAM,CAAC8C,OAAP,CAAgBC,OAAD,IAAa;AACxB,cAAMC,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;AACAD,QAAAA,QAAQ,CAACE,MAAT,CAAgB,WAAhB,EAA6BZ,IAAI,CAAC3B,EAAlC;AACAqC,QAAAA,QAAQ,CAACE,MAAT,CAAgB,KAAhB,EAAuBH,OAAO,CAAC3B,GAA/B;AACA5B,QAAAA,WAAW,CAACwD,QAAD,CAAX,CAAsBX,IAAtB,CAA2BC,IAAI,IAAIrC,SAAS,CAAC,EAAD,CAA5C;AACH,OALD;AAMAA,MAAAA,SAAS,CAAC,EAAD,CAAT,CAPU,CAQV;;AACAH,MAAAA,IAAI,CAACgD,OAAL,CAAcC,OAAD,IAAa;AACtBtD,QAAAA,iBAAiB,CAAC6C,IAAI,CAAC3B,EAAN,EAAUoC,OAAO,CAACpC,EAAlB,EAAsBoC,OAAO,CAACrC,WAA9B,CAAjB,CAA4D2B,IAA5D,CAAiEC,IAAI,IAAIvC,OAAO,CAAC,EAAD,CAAhF;AACH,OAFD;AAGAX,MAAAA,kBAAkB,CAACkB,eAAe,CAACJ,IAAjB,EAAuBI,eAAe,CAACK,EAAvC,EAA2C2B,IAAI,CAAC3B,EAAhD,CAAlB;AACH,KAdL;AAgBAf,IAAAA,MAAM;AACT,GAlBD;;AAoBA,sBACI,QAAC,KAAD;AACI,IAAA,IAAI,EAAED,IADV;AAEI,IAAA,MAAM,EAAEC,MAFZ;AAGI,IAAA,IAAI,EAAC,IAHT;AAII,IAAA,QAAQ,MAJZ;AAAA,4BAMI,QAAC,KAAD,CAAO,MAAP;AAAc,MAAA,WAAW,MAAzB;AAAA,6BACI,QAAC,KAAD,CAAO,KAAP;AAAa,QAAA,EAAE,EAAC,+BAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,YANJ,eAWI,QAAC,KAAD,CAAO,IAAP;AAAA,8BACI,QAAC,QAAD;AAAU,QAAA,SAAS,EAAC,WAApB;AAAA,gCACI,QAAC,QAAD,CAAU,MAAV;AAAA,oBAAkBC,OAAO,CAAC+C,YAAR,CAAqB1C,IAArB,IAA6B;AAA/C;AAAA;AAAA;AAAA;AAAA,gBADJ,eAEI,QAAC,QAAD,CAAU,IAAV;AAAA,oBACKL,OAAO,CAACsD,KAAR,CAAc3B,GAAd,CAAkBY,EAAE,iBACjB,QAAC,QAAD,CAAU,IAAV;AAAe,YAAA,OAAO,EAAE,MAAMvC,OAAO,CAACuD,eAAR,CAAwBhB,EAAxB,CAA9B;AAAA,sBAAwEA,EAAE,CAAClC;AAA3E,aAAgEkC,EAAE,CAACzB,EAAnE;AAAA;AAAA;AAAA;AAAA,kBADH;AADL;AAAA;AAAA;AAAA;AAAA,gBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,eASI,QAAC,QAAD;AAAU,QAAA,SAAS,EAAC,WAApB;AAAA,gCACI,QAAC,QAAD,CAAU,MAAV;AAAA,oBAAkBd,OAAO,CAACgD,cAAR,CAAuB3C,IAAvB,IAA+B;AAAjD;AAAA;AAAA;AAAA;AAAA,gBADJ,eAEI,QAAC,QAAD,CAAU,IAAV;AAAA,oBACKL,OAAO,CAACwD,OAAR,CAAgB7B,GAAhB,CAAoBY,EAAE,iBACnB,QAAC,QAAD,CAAU,IAAV;AAAe,YAAA,OAAO,EAAE,MAAMvC,OAAO,CAACyD,iBAAR,CAA0BlB,EAA1B,CAA9B;AAAA,sBAA0EA,EAAE,CAAClC;AAA7E,aAAkEkC,EAAE,CAACzB,EAArE;AAAA;AAAA;AAAA;AAAA,kBADH;AADL;AAAA;AAAA;AAAA;AAAA,gBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,cATJ,eAiBI,QAAC,QAAD;AAAU,QAAA,SAAS,EAAC,WAApB;AAAA,gCACI,QAAC,QAAD,CAAU,MAAV;AAAA,oBAAkBd,OAAO,CAACS,eAAR,CAAwBJ,IAAxB,IAAgC;AAAlD;AAAA;AAAA;AAAA;AAAA,gBADJ,eAEI,QAAC,QAAD,CAAU,IAAV;AAAA,oBACKL,OAAO,CAAC0D,QAAR,CAAiB/B,GAAjB,CAAqBY,EAAE,iBACpB,QAAC,QAAD,CAAU,IAAV;AAAe,YAAA,OAAO,EAAE,MAAMD,uBAAuB,CAACC,EAAD,CAArD;AAAA,sBAAwEA,EAAE,CAAClC;AAA3E,aAAgEkC,EAAE,CAACzB,EAAnE;AAAA;AAAA;AAAA;AAAA,kBADH;AADL;AAAA;AAAA;AAAA;AAAA,gBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,cAjBJ,eAyBI,QAAC,IAAD;AAAA,gCACI,QAAC,IAAD,CAAM,OAAN;AACI,UAAA,KAAK,EAAE;AAAE6C,YAAAA,SAAS,EAAE;AAAb,WADX;AAEI,UAAA,WAAW,EAAC,0JAFhB;AAGI,UAAA,KAAK,EAAEtD,IAHX;AAII,UAAA,QAAQ,EAAGoB,CAAD,IAAOnB,OAAO,CAACmB,CAAC,CAACI,MAAF,CAASQ,KAAV;AAJ5B;AAAA;AAAA;AAAA;AAAA,gBADJ,eAOI,QAAC,IAAD,CAAM,OAAN;AACI,UAAA,KAAK,EAAE;AAAEsB,YAAAA,SAAS,EAAE;AAAb,WADX;AAEI,UAAA,WAAW,EAAC,mIAFhB;AAGI,UAAA,IAAI,EAAC,QAHT;AAII,UAAA,KAAK,EAAEpD,KAJX;AAKI,UAAA,QAAQ,EAAGkB,CAAD,IAAOjB,QAAQ,CAACoD,MAAM,CAACnC,CAAC,CAACI,MAAF,CAASQ,KAAV,CAAP;AAL7B;AAAA;AAAA;AAAA;AAAA,gBAPJ;AAAA;AAAA;AAAA;AAAA;AAAA,cAzBJ,eAwCI;AAAA;AAAA;AAAA;AAAA,cAxCJ,eAyCI,QAAC,MAAD;AACI,QAAA,OAAO,EAAE,cADb;AAEI,QAAA,OAAO,EAAEf,QAFb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAzCJ,EA+CKnB,MAAM,CAACwB,GAAP,CAAYP,CAAD,iBACR,QAAC,GAAD;AAEI,QAAA,SAAS,EAAC,MAFd;AAAA,gCAII,QAAC,GAAD;AAAK,UAAA,EAAE,EAAE,CAAT;AAAA,iCACI,QAAC,IAAD,CAAM,OAAN;AACI,YAAA,IAAI,EAAC,MADT;AAEI,YAAA,QAAQ,EAAGK,CAAD,IAAOD,UAAU,CAACC,CAAD,EAAIL,CAAC,CAACL,MAAN;AAF/B;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBAJJ,eAUI,QAAC,GAAD;AAAK,UAAA,EAAE,EAAE,CAAT;AAAA,iCACI,QAAC,MAAD;AAAQ,YAAA,OAAO,EAAE,MAAMM,WAAW,CAACD,CAAC,CAACL,MAAH,CAAlC;AAA8C,YAAA,OAAO,EAAE,gBAAvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBAVJ;AAAA,SACSK,CAAC,CAACL,MADX;AAAA;AAAA;AAAA;AAAA,cADH,CA/CL,eA+DI;AAAA;AAAA;AAAA;AAAA,cA/DJ,eAgEI,QAAC,MAAD;AACI,QAAA,OAAO,EAAE,cADb;AAEI,QAAA,OAAO,EAAEJ,OAFb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAhEJ,EAuEQV,IAAI,CAAC0B,GAAL,CAASP,CAAC,iBACN,QAAC,GAAD;AAAK,QAAA,SAAS,EAAC,uDAAf;AAAA,gCACI,QAAC,GAAD;AAAK,UAAA,EAAE,EAAE,CAAT;AAAA,iCACI,QAAC,QAAD;AAAU,YAAA,SAAS,EAAC,WAApB;AAAA,oCACI,QAAC,QAAD,CAAU,MAAV;AAAA,wBAAkBA,CAAC,CAACR,KAAF,IAAW;AAA7B;AAAA;AAAA;AAAA;AAAA,oBADJ,eAEI,QAAC,QAAD,CAAU,IAAV;AAAA,wBACKZ,OAAO,CAAC6D,UAAR,CAAmBlC,GAAnB,CAAuBY,EAAE,iBACtB,QAAC,QAAD,CAAU,IAAV;AAAe,gBAAA,OAAO,EAAE,MAAML,UAAU,CAACK,EAAE,CAACzB,EAAJ,EAAQyB,EAAE,CAAClC,IAAX,EAAiBe,CAAC,CAACL,MAAnB,CAAxC;AAAA,0BAAiFwB,EAAE,CAAClC;AAApF,iBAAyEkC,EAAE,CAACzB,EAA5E;AAAA;AAAA;AAAA;AAAA,sBADH;AADL;AAAA;AAAA;AAAA;AAAA,oBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBADJ,eAWI,QAAC,GAAD;AAAK,UAAA,EAAE,EAAE,CAAT;AAAA,iCACI,QAAC,IAAD,CAAM,OAAN;AACI,YAAA,WAAW,EAAC,8IADhB;AAEI,YAAA,KAAK,EAAEM,CAAC,CAACP,WAFb;AAGI,YAAA,QAAQ,EAAGY,CAAD,IAAOW,cAAc,CAACX,CAAD,EAAIL,CAAC,CAACL,MAAN;AAHnC;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBAXJ,eAkBI,QAAC,GAAD;AAAK,UAAA,EAAE,EAAE,CAAT;AAAA,iCACI,QAAC,MAAD;AACI,YAAA,OAAO,EAAE,gBADb;AAEI,YAAA,OAAO,EAAE,MAAMG,UAAU,CAACE,CAAC,CAACL,MAAH,CAF7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBAlBJ;AAAA,SAA4EK,CAAC,CAACL,MAA9E;AAAA;AAAA;AAAA;AAAA,cADJ,CAvER;AAAA;AAAA;AAAA;AAAA;AAAA,YAXJ,eAiHI,QAAC,KAAD,CAAO,MAAP;AAAA,8BACI,QAAC,MAAD;AAAQ,QAAA,OAAO,EAAE,iBAAjB;AAAoC,QAAA,OAAO,EAAE+B,UAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,eAEI,QAAC,MAAD;AAAQ,QAAA,OAAO,EAAE,gBAAjB;AAAmC,QAAA,OAAO,EAAE/C,MAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAFJ,eAGI,QAAC,MAAD;AAAQ,QAAA,OAAO,EAAEgC,UAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAHJ;AAAA;AAAA;AAAA;AAAA;AAAA,YAjHJ;AAAA;AAAA;AAAA;AAAA;AAAA,UADJ;AAyHH,CA7N6B,kCAA9B;MAAMlC,a;AA+NN,eAAeA,aAAf","sourcesContent":["import React, { useContext, useEffect, useState } from 'react'\r\nimport { Modal, Button, Form, Dropdown, Row, Col } from 'react-bootstrap'\r\nimport { fetchProperties, fetchTypes, fetchGenders, createProperty, fetchCatalogs, createCatalogsInfo } from '../../http/productAPI'\r\nimport { Context } from '../../index'\r\nimport { observer } from 'mobx-react-lite'\r\nimport { createProduct, uploadImage, uploadProductInfo } from '../../http/productAPI'\r\n\r\nconst CreateProduct = observer(({ show, onHide }) => {\r\n\r\n    const { product } = useContext(Context)\r\n    const [info, setInfo] = useState([])\r\n    const [images, setImages] = useState([])\r\n\r\n    const [name, setName] = useState('')\r\n    const [price, setPrice] = useState('')\r\n    const [selectedCatalog, setSelectedCatalog] = useState(null)\r\n\r\n\r\n\r\n    const addInfo = () => {\r\n        setInfo([...info, { title: \"\", description: \"\", id: \"\", number: Date.now() }])\r\n    }\r\n\r\n    const removeInfo = (number) => {\r\n        setInfo(info.filter(i => i.number !== number))\r\n    }\r\n\r\n    const removeImage = (number) => {\r\n        setImages(images.filter(i => i.number !== number))\r\n    }\r\n\r\n    const addImage = () => {\r\n        setImages([...images, { src: '', number: Date.now() }])\r\n    }\r\n\r\n    const selectFile = (e, number) => {\r\n        const newFiles = [...images]\r\n        newFiles.map((item) => {\r\n            if (item.number === number) {\r\n                item.src = e.target.files[0]\r\n            }\r\n            return item\r\n        })\r\n    }\r\n\r\n    const showImages = () => {\r\n        console.log(images)\r\n    }\r\n\r\n    const selectInfo = (id, title, number) => {\r\n        console.log(id, title, number)\r\n        const newInfo = [...info]\r\n        newInfo.map((item) => {\r\n            if (item.number === number) {\r\n                item.title = title\r\n                item.id = id\r\n            }\r\n            return item\r\n        })\r\n        setInfo(newInfo)\r\n    }\r\n\r\n    const addDescription = (e, number) => {\r\n        const newInfo = [...info]\r\n        newInfo.map((item) => {\r\n            if (item.number === number) {\r\n                item.description = e.target.value\r\n            }\r\n            return item\r\n        })\r\n        setInfo(newInfo)\r\n    }\r\n\r\n    const selectedCatalogHandling = (el) => {\r\n        product.setSelectedCatalog(el)\r\n        setSelectedCatalog(el)\r\n    }\r\n\r\n\r\n    useEffect(() => {\r\n        fetchTypes().then(data => product.setTypes(data))\r\n        fetchGenders().then(data => product.setGenders(data))\r\n        fetchProperties().then(data => product.setProperties(data))\r\n        fetchCatalogs().then(data => product.setCatalogs(data))\r\n    }, [])\r\n\r\n    //name, price, typeId, genderId\r\n    const addProduct = () => {\r\n        createProduct(name, price, product.selectedType.id, product.selectedGender.id)\r\n            .then(data => {\r\n                images.forEach((element) => {\r\n                    const formData = new FormData()\r\n                    formData.append('productId', data.id)\r\n                    formData.append('scr', element.src)\r\n                    uploadImage(formData).then(data => setImages([]))\r\n                })\r\n                setImages([])\r\n                //add info\r\n                info.forEach((element) => {\r\n                    uploadProductInfo(data.id, element.id, element.description).then(data => setInfo([]))\r\n                })\r\n                createCatalogsInfo(selectedCatalog.name, selectedCatalog.id, data.id)\r\n            })\r\n\r\n        onHide()\r\n    }\r\n\r\n    return (\r\n        <Modal\r\n            show={show}\r\n            onHide={onHide}\r\n            size=\"lg\"\r\n            centered\r\n        >\r\n            <Modal.Header closeButton>\r\n                <Modal.Title id=\"contained-modal-title-vcenter\">\r\n                    Добавить новый товар\r\n                </Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n                <Dropdown className=\"mt-2 mb-2\">\r\n                    <Dropdown.Toggle>{product.selectedType.name || 'Выберете тип товара'}</Dropdown.Toggle>\r\n                    <Dropdown.Menu>\r\n                        {product.types.map(el =>\r\n                            <Dropdown.Item onClick={() => product.setSelectedType(el)} key={el.id}>{el.name}</Dropdown.Item>\r\n                        )}\r\n                    </Dropdown.Menu>\r\n                </Dropdown>\r\n                <Dropdown className=\"mt-2 mb-2\">\r\n                    <Dropdown.Toggle>{product.selectedGender.name || 'Выберете вид товара'}</Dropdown.Toggle>\r\n                    <Dropdown.Menu>\r\n                        {product.genders.map(el =>\r\n                            <Dropdown.Item onClick={() => product.setSelectedGender(el)} key={el.id}>{el.name}</Dropdown.Item>\r\n                        )}\r\n                    </Dropdown.Menu>\r\n                </Dropdown>\r\n                <Dropdown className=\"mt-2 mb-2\">\r\n                    <Dropdown.Toggle>{product.selectedCatalog.name || 'Выберете каталог для товара'}</Dropdown.Toggle>\r\n                    <Dropdown.Menu>\r\n                        {product.catalogs.map(el =>\r\n                            <Dropdown.Item onClick={() => selectedCatalogHandling(el)} key={el.id}>{el.name}</Dropdown.Item>\r\n                        )} \r\n                    </Dropdown.Menu>\r\n                </Dropdown>\r\n                <Form>\r\n                    <Form.Control\r\n                        style={{ marginTop: 3 }}\r\n                        placeholder=\"Введите наименование товара\"\r\n                        value={name}\r\n                        onChange={(e) => setName(e.target.value)}\r\n                    />\r\n                    <Form.Control\r\n                        style={{ marginTop: 3 }}\r\n                        placeholder=\"Введите стоимоcть товара\"\r\n                        type=\"number\"\r\n                        value={price}\r\n                        onChange={(e) => setPrice(Number(e.target.value))}\r\n                    />\r\n                </Form>\r\n                <hr />\r\n                <Button\r\n                    variant={\"outline-dark\"}\r\n                    onClick={addImage}\r\n                >\r\n                    Добавить новую фотографию\r\n                </Button>\r\n                {images.map((i) =>\r\n                    <Row\r\n                        key={i.number}\r\n                        className=\"mt-3\"\r\n                    >\r\n                        <Col md={6}>\r\n                            <Form.Control\r\n                                type=\"file\"\r\n                                onChange={(e) => selectFile(e, i.number)}\r\n                            />\r\n                        </Col>\r\n                        <Col md={6}>\r\n                            <Button onClick={() => removeImage(i.number)} variant={\"outline-danger\"}>x</Button>\r\n                        </Col>\r\n                    </Row>\r\n                )}\r\n                <hr />\r\n                <Button\r\n                    variant={\"outline-dark\"}\r\n                    onClick={addInfo}\r\n                >\r\n                    Добавить характеристику товара\r\n                </Button>\r\n                {\r\n                    info.map(i =>\r\n                        <Row className=\"mt-3 d-flex align-items-center justify-content-center\" key={i.number}>\r\n                            <Col md={4}>\r\n                                <Dropdown className=\"mt-2 mb-2\">\r\n                                    <Dropdown.Toggle>{i.title || 'Выберите свойство товара'}</Dropdown.Toggle>\r\n                                    <Dropdown.Menu>\r\n                                        {product.properties.map(el =>\r\n                                            <Dropdown.Item onClick={() => selectInfo(el.id, el.name, i.number)} key={el.id}>{el.name}</Dropdown.Item>\r\n                                        )}\r\n                                    </Dropdown.Menu>\r\n                                </Dropdown>\r\n                            </Col>\r\n                            <Col md={4}>\r\n                                <Form.Control\r\n                                    placeholder=\"Введите значение свойства\"\r\n                                    value={i.description}\r\n                                    onChange={(e) => addDescription(e, i.number)}\r\n                                />\r\n                            </Col>\r\n                            <Col md={4}>\r\n                                <Button\r\n                                    variant={\"outline-danger\"}\r\n                                    onClick={() => removeInfo(i.number)}\r\n                                >\r\n                                    x\r\n                                </Button>\r\n                            </Col>\r\n                        </Row>\r\n                    )\r\n                }\r\n            </Modal.Body>\r\n            <Modal.Footer>\r\n                <Button variant={\"outline-success\"} onClick={addProduct}>Сохранить</Button>\r\n                <Button variant={\"outline-danger\"} onClick={onHide}>Закрыть</Button>\r\n                <Button onClick={showImages}>в консоли</Button>\r\n            </Modal.Footer>\r\n        </Modal>\r\n    )\r\n})\r\n\r\nexport default CreateProduct;"]},"metadata":{},"sourceType":"module"}