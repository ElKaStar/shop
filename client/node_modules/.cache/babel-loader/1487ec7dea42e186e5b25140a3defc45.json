{"ast":null,"code":"import _slicedToArray from\"C:/Users/licos/Desktop/projects/shop_online/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useEffect,useState}from'react';import{Row,Col,Card,Button,Container,Badge}from\"react-bootstrap\";import{observer}from'mobx-react-lite';import{Context}from'../index';import{fetchNewCatalogsInfo}from'../http/productAPI';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var NewItems=observer(function(){var _useContext=useContext(Context),product=_useContext.product;var _useState=useState(3),_useState2=_slicedToArray(_useState,2),limit=_useState2[0],setLimit=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),currentCount=_useState4[0],setCurrentCount=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),state=_useState6[0],setState=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),arrNewProducts=_useState8[0],setArrNewProducts=_useState8[1];var loadMoreNewProducts=function loadMoreNewProducts(){setLimit(limit+3);countLimit=0;};var countLimit=0;var currEl=0;var addNewProducts=function addNewProducts(state){if(!state){return null;}//console.log(state)\nvar resArr=[];state.forEach(function(item){if(currEl!==item.id){var newElArr={id:item.id,price:item.price,images:[item.scr],name:item.name};resArr.push(newElArr);}else{resArr.forEach(function(el){if(el.id===item.id){el.images.push(item.scr);return el;}return el;});}currEl=item.id;});setArrNewProducts(resArr);console.log('arrNewProducts',arrNewProducts);};useEffect(function(){console.log('useEffect1');fetchNewCatalogsInfo().then(function(data){return product.setNewProducts(data);});},[]);useEffect(function(){console.log('useEffect2');addNewProducts(state);},[state,limit]);useEffect(function(){console.log('useEffect3',limit);setState(product.newProducts);},[product.newProducts]);if(!arrNewProducts||arrNewProducts.length===0){return/*#__PURE__*/_jsx(Container,{style:{marginTop:\"30px\",marginBottom:\"30px\"},children:/*#__PURE__*/_jsx(Row,{className:\"d-flex justify-content-center align-items-center\",children:/*#__PURE__*/_jsx(\"div\",{style:{border:\"1px solid black\",fontSize:\"22px\",paddingTop:\"15px\",paddingBottom:\"15px\",paddingLeft:\"30px\",paddingRight:\"30px\"},children:\"\\u041D\\u0430\\u0448\\u0438 \\u043D\\u043E\\u0432\\u0438\\u043D\\u043A\\u0438 \\u0443\\u0436\\u0435 \\u0431\\u0443\\u0434\\u0443\\u0442 \\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B \\u0432 \\u0431\\u043B\\u0438\\u0436\\u0430\\u0439\\u0448\\u0435\\u0435 \\u0432\\u0440\\u0435\\u043C\\u044F\"})})});}return/*#__PURE__*/_jsxs(Container,{style:{marginTop:\"30px\",marginBottom:\"30px\"},children:[/*#__PURE__*/_jsx(Row,{className:\"d-flex justify-content-center align-items-center\",children:/*#__PURE__*/_jsx(\"div\",{style:{border:\"1px solid black\",fontSize:\"22px\",paddingTop:\"15px\",paddingBottom:\"15px\",paddingLeft:\"30px\",paddingRight:\"30px\"},children:\"\\u041D\\u0430\\u0448\\u0438 \\u043D\\u043E\\u0432\\u0438\\u043D\\u043A\\u0438\"})}),/*#__PURE__*/_jsxs(Container,{className:\"d-flex justify-content-center align-items-center flex-column\",children:[/*#__PURE__*/_jsx(Row,{style:{marginTop:\"30px\"},children:arrNewProducts.map(function(el){countLimit++;if(countLimit>limit){return/*#__PURE__*/_jsx(\"div\",{});}return/*#__PURE__*/_jsx(Col,{className:\"d-flex justify-content-center align-items-center mt-3\",md:4,children:/*#__PURE__*/_jsxs(Card,{className:\"card_new_product\",children:[/*#__PURE__*/_jsx(Card.Img,{className:\"img_card_new_product\",onMouseOver:function onMouseOver(e){return e.currentTarget.src=process.env.REACT_APP_API_URL+\"\".concat(el.images[0]);},onMouseOut:function onMouseOut(e){return e.currentTarget.src=!el.images[1]?process.env.REACT_APP_API_URL+\"\".concat(el.images[0]):process.env.REACT_APP_API_URL+\"\".concat(el.images[1]);},variant:\"top\",src:process.env.REACT_APP_API_URL+\"\".concat(el.images[0])}),/*#__PURE__*/_jsx(Card.Body,{className:\"card_body\",children:/*#__PURE__*/_jsxs(Card.Text,{children:[/*#__PURE__*/_jsx(\"hr\",{style:{paddingTop:'0px',marginTop:'0px'}}),/*#__PURE__*/_jsxs(Row,{className:\"d-flex justify-content-between ml-2 mr-2 mt-2 pt-2\",children:[/*#__PURE__*/_jsxs(\"h3\",{style:{fontSize:'18px'},children:[el.name,\" \",/*#__PURE__*/_jsx(Badge,{variant:\"secondary\",className:\"ml-2\",children:\"New\"})]}),/*#__PURE__*/_jsx(\"h3\",{style:{fontSize:'18px'},children:\"\".concat(el.price,\" p.\")})]})]})})]})});})}),/*#__PURE__*/_jsx(Row,{children:limit>=arrNewProducts.length?'':/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return loadMoreNewProducts();},className:\"load-more\",variant:\"light\",children:\"\\u041F\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440\\u0435\\u0442\\u044C \\u0435\\u0449\\u0435..\"})})]})]});});export default NewItems;","map":{"version":3,"sources":["C:/Users/licos/Desktop/projects/shop_online/client/src/components/NewItems.js"],"names":["React","useContext","useEffect","useState","Row","Col","Card","Button","Container","Badge","observer","Context","fetchNewCatalogsInfo","NewItems","product","limit","setLimit","currentCount","setCurrentCount","state","setState","arrNewProducts","setArrNewProducts","loadMoreNewProducts","countLimit","currEl","addNewProducts","resArr","forEach","item","id","newElArr","price","images","scr","name","push","el","console","log","then","data","setNewProducts","newProducts","length","marginTop","marginBottom","border","fontSize","paddingTop","paddingBottom","paddingLeft","paddingRight","map","e","currentTarget","src","process","env","REACT_APP_API_URL"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from 'react'\r\nimport { Row, Col, Card, Button, Container, Badge } from \"react-bootstrap\";\r\nimport { observer } from 'mobx-react-lite'\r\nimport { Context } from '../index'\r\nimport { fetchNewCatalogsInfo } from '../http/productAPI'\r\n\r\nconst NewItems = observer(() => {\r\n  const { product } = useContext(Context)\r\n  const [limit, setLimit] = useState(3);\r\n\r\n  const [currentCount, setCurrentCount] = useState(0);\r\n  const [state, setState] = useState([])\r\n  const [arrNewProducts, setArrNewProducts] = useState([])\r\n\r\n  const loadMoreNewProducts = () => {\r\n    setLimit(limit + 3)\r\n    countLimit = 0\r\n  };\r\n  let countLimit = 0\r\n  let currEl = 0\r\n\r\n  const addNewProducts = (state) => {\r\n\r\n    if (!state) {\r\n      return null\r\n    }\r\n    //console.log(state)\r\n    const resArr = []\r\n    state.forEach(item => {\r\n      if (currEl !== item.id) {\r\n        const newElArr = {\r\n          id: item.id,\r\n          price: item.price,\r\n          images: [item.scr],\r\n          name: item.name\r\n        }\r\n        resArr.push(newElArr)\r\n      } else {\r\n        resArr.forEach(el => {\r\n          if (el.id === item.id) {\r\n            el.images.push(item.scr)\r\n            return el\r\n          }\r\n          return el\r\n        })\r\n      }\r\n      currEl = item.id\r\n    })\r\n    setArrNewProducts(resArr)\r\n    console.log('arrNewProducts', arrNewProducts)\r\n  }\r\n\r\n  useEffect(() => {\r\n    console.log('useEffect1')\r\n    fetchNewCatalogsInfo().then(data => product.setNewProducts(data))\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    console.log('useEffect2')\r\n    addNewProducts(state)\r\n  }, [state, limit])\r\n\r\n  useEffect(() => {\r\n    console.log('useEffect3', limit)\r\n    setState(product.newProducts)\r\n\r\n  }, [product.newProducts])\r\n\r\n\r\n\r\n\r\n\r\n  if (!arrNewProducts || arrNewProducts.length === 0) {\r\n    return (\r\n      <Container style={{ marginTop: \"30px\", marginBottom: \"30px\" }}>\r\n        <Row className=\"d-flex justify-content-center align-items-center\">\r\n          <div\r\n            style={{\r\n              border: \"1px solid black\",\r\n              fontSize: \"22px\",\r\n              paddingTop: \"15px\",\r\n              paddingBottom: \"15px\",\r\n              paddingLeft: \"30px\",\r\n              paddingRight: \"30px\"\r\n            }}\r\n          >\r\n            Наши новинки уже будут доступны в ближайшее время\r\n          </div>\r\n        </Row>\r\n      </Container>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <Container style={{ marginTop: \"30px\", marginBottom: \"30px\" }}>\r\n      <Row className=\"d-flex justify-content-center align-items-center\">\r\n        <div\r\n          style={{\r\n            border: \"1px solid black\",\r\n            fontSize: \"22px\",\r\n            paddingTop: \"15px\",\r\n            paddingBottom: \"15px\",\r\n            paddingLeft: \"30px\",\r\n            paddingRight: \"30px\"\r\n          }}\r\n        >\r\n          Наши новинки\r\n        </div>\r\n      </Row>\r\n      <Container className=\"d-flex justify-content-center align-items-center flex-column\">\r\n        <Row style={{ marginTop: \"30px\" }}>\r\n          {arrNewProducts.map(el => {\r\n            countLimit++\r\n            if (countLimit > limit) {\r\n              return (<div></div>)\r\n            }\r\n            return (\r\n              <Col\r\n                className=\"d-flex justify-content-center align-items-center mt-3\"\r\n                md={4}\r\n              >\r\n                <Card className=\"card_new_product\">\r\n                  <Card.Img\r\n                    className=\"img_card_new_product\"\r\n                    onMouseOver={e => (e.currentTarget.src = process.env.REACT_APP_API_URL + `${el.images[0]}`)}\r\n                    onMouseOut={e => (e.currentTarget.src = (!el.images[1] ? process.env.REACT_APP_API_URL + `${el.images[0]}` : process.env.REACT_APP_API_URL + `${el.images[1]}`))}\r\n                    variant=\"top\"\r\n                    src={(process.env.REACT_APP_API_URL + `${el.images[0]}`)}\r\n                  />\r\n                  <Card.Body className=\"card_body\">\r\n                    <Card.Text>\r\n                      <hr style={{ paddingTop: '0px', marginTop: '0px' }} />\r\n                      <Row className=\"d-flex justify-content-between ml-2 mr-2 mt-2 pt-2\">\r\n                        <h3 style={{ fontSize: '18px' }}>{el.name} <Badge variant=\"secondary\" className=\"ml-2\">New</Badge></h3>\r\n                        <h3 style={{ fontSize: '18px' }}>{`${el.price} p.`}</h3>\r\n                      </Row>\r\n                    </Card.Text>\r\n                  </Card.Body>\r\n                </Card>\r\n              </Col>\r\n            );\r\n          })}\r\n        </Row>\r\n        <Row>\r\n          {limit >= arrNewProducts.length ? '' :\r\n            <Button\r\n              onClick={() => loadMoreNewProducts()}\r\n              className=\"load-more\"\r\n              variant=\"light\"\r\n            >\r\n              Посмотреть еще..\r\n            </Button>\r\n          }\r\n        </Row>\r\n      </Container>\r\n    </Container>\r\n  );\r\n})\r\n\r\nexport default NewItems"]},"metadata":{},"sourceType":"module"}